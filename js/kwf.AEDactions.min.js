/*!
 * KWF Action-Edit-Delete Actions Script: kwf.AEDactions.js
 * Based on DOMcraft
 * 
 * @author Christoffer Lindahl <christoffer@kekos.se>
 * @date 2013-07-16
 * @version 1.0
 */
Kwf.AEDactions=(function(b){function c(g,j,k){var h,f;k.reset();for(h in g){f=b.toDOMnode(g[h]);f.addClass("kwf-aed-item-added");j.append(f)}}function d(g,j,i){var f=b(j),h=b.toDOMnode(g);f.parent().insertBefore(h,f);f.remove();b.Boxing.close()}function a(h){var g,f={};for(g in h){f[g]=b(h[g]);f[g].addClass("kwf-aed-item-deleted")}b.Boxing.close();setTimeout(function(){for(g in f){f[g].remove()}},1000)}function e(g){var f,i=g.request.data,h;if(g.target.content_type==="application/json"){f=g.target.page.content||g.target.page;if(f.action){switch(f.action){case"add":h=b(i.getAttribute("data-list-view"));c(f.views,h,i);break;case"edit":d(f.views[0],f.id,i);break;case"delete":a(f.ids);break;default:throw new Error("AEDactions onResponse(): invalid action: "+f.action)}}}}b.ready(function(){b.ContentContext.addEvent("afterload",e);b.BoxingContext.addEvent("afterload",e);b("content").addEvent("click",function(g){var f=b(g.target);if(f.hasClass("action-delete")){g.preventDefault();b.BoxingContext.request(f.attr("href"),null,300,200)}})});return{add:c,edit:d,"delete":a}}(Kwf));