function elem(b){try{return document.getElementById(b)||document.all[b]}catch(a){return false}}function addEvent(c,d,b,a){var e=b;if(a){e=function(f){b.call(a,f)}}if(c.addEventListener){c.addEventListener(d,e,0)}else{if(c.attachEvent){c.attachEvent("on"+d,e)}}}function removeEvent(b,c,a){if(b.removeEventListener){b.removeEventListener(c,a,0)}else{if(b.attachEvent){b.detachEvent("on"+c,a)}}}function addSubmitEvent(b,a){addEvent(b,"click",function(c){window.submit_target=getTarget(c)});addEvent(b,"submit",a)}function isWs(a){return !(/[^\t\n\r ]/.test(a.data))}function is_ignorable(a){return(a.nodeType==8)||((a.nodeType==3)&&isWs(a))}function previousNode(a){while(a=a.previousSibling){if(!is_ignorable(a)){return a}}return null}function nextNode(a){while(a=a.nextSibling){if(!is_ignorable(a)){return a}}return null}function firstChildElement(b){var a=b.childNodes,d;for(d=0;d<a.length;d++){if(!is_ignorable(a[d])){return a[d]}}return null}function lastChildElement(b){var a=b.childNodes,d;for(d=a.length-1;d>=0;d--){if(!is_ignorable(a[d])){return a[d]}}return null}function hasClass(a,b){return(a.className?a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)")):0)}function addClass(a,b){if(!hasClass(a,b)){a.className+=" "+b}}function removeClass(a,b){a.className=a.className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)")," ").replace(/\s+/g," ").replace(/^\s|\s$/,"")}function giveOpacity(b,a){if(typeof b.filters=="object"){b.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+a+")"}}function getTarget(a){a=a||window.event;return a.target||a.srcElement}function returnFalse(a){(window.event)?event.returnValue=false:a.preventDefault()}function parseJSON(j){try{j=JSON.parse(j)}catch(e){try{j=eval("("+j+")")}catch(e){}}return j}function var_dump(b,f){function a(g){var h,j="";for(h=0;h<(g*2);h++){j+=" "}return j}var d=typeof b,e="",c;if(!f){f=1}else{if(f>5){return""}}if(d=="object"){e+="{\n";for(c in b){e+=a(f)+c+": "+var_dump(b[c],f+1)}e+=a(f)+"}"}else{e=b.toString()}e="("+d+") "+e+"\n";if(f==1){alert(e)}else{return e}}function toDOMnode(a){var b=document.createElement("div");b.innerHTML=a;return b.firstChild}var ajax={onbeforeajax:null,onafterajax:null,get:function(b,d,a,c){c=(typeof c=="object"?"?"+ajax.array2query(c):"");return ajax.send(b+c,"GET",d,a,null)},post:function(b,e,a,d,c){d=(d.nodeType?ajax.form2query(d,c):ajax.array2query(d));return ajax.send(b,"POST",e,a,d)},upload:function(g,i,h,p,e){if(typeof File!="undefined"){var r=p.files,s,q,n,b,o="---------------------------"+new Date().getTime(),u="--"+o+"\r\n";if(typeof FileReader=="undefined"){s=r[0];n=(s.fileName!=null)?s.fileName:s.name;return ajax.send(g,"POST",i,h,s,[["X-ajax-upload",encodeURIComponent(n)]])}else{b=new FileReader();b.onloadend=function(){u+='Content-Disposition: form-data; name="'+p.name+'"; filename="'+n+'"\r\nContent-Type: '+s.type+"\r\n\r\n"+b.result+"\r\n--"+o;if(q==r.length){u+="\r"+ajax.form2query(p.form,e,o);if(q){return ajax.send(g,"POST",i,h,u+"--",[["Content-Type","multipart/form-data; boundary="+o],["Content-Length",u.length]],1)}}};for(q=0;q<r.length;q++){s=r[q];n=(s.fileName!=null)?s.fileName:s.name;if(q){u+="\r\n"}b.readAsBinaryString(s)}}}else{var j=p.parentNode,d,l,c,t=ajax,k=document.body,m;if(t.onbeforeajax!=null){t.onbeforeajax()}d=k.appendChild(toDOMnode('<form style="visibility: hidden;" action="'+g+'" method="post" enctype="multipart/form-data" target="ajax_upload_frame"><input type="hidden" name="X-ajax-request" value="true" /><input type="hidden" name="X-frame-upload" value="true" /></form>'));j.removeChild(p);d.appendChild(p);l=k.appendChild(toDOMnode('<iframe style="visibility: hidden;" src="javascript: false;" name="ajax_upload_frame" id="ajax_upload_frame"></iframe>'));addEvent(l,"load",function(){setTimeout(function(){c=(l.contentDocument)?l.contentDocument:l.contentWindow.document;m=c.body.innerHTML;i({response:parseJSON(m),content_type:(m.substring(0,1)=="{"&&m.substring(m.length-1)=="}"?"application/json":"text/plain"),status:"200"});k.removeChild(l);if(t.onafterajax!=null){t.onafterajax()}},1)});d.submit();k.removeChild(d);j.appendChild(p)}},send:function(c,b,n,f,i,d,m){var e=(window.ActiveXObject)?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest(),g,k=0,j,l=ajax;e.open(b,c);e.setRequestHeader("X-ajax-request","true");if(typeof d=="object"){for(j in d){if(d[j][0]=="Content-Type"){k=1}e.setRequestHeader(d[j][0],d[j][1])}}if(!k){e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}e.onreadystatechange=function(){if(e.readyState==4){k=e.getResponseHeader("Content-Type");k=k.substring(0,k.indexOf(";"));g={page:e.responseText,content_type:k,status:e.status};if(g.content_type=="application/json"){g.page=parseJSON(g.page)}if(l.onafterajax!=null){l.onafterajax()}if(e.status==200){if(e.getResponseHeader("X-ajax-error")){g.success=0;f(g)}else{g.success=1;n(g)}}else{if(e.status==404){g={success:0,page:{error:["Filen hittades inte."]},content_type:"application/json",status:"404"};f(g)}}}};if(l.onbeforeajax!=null){l.onbeforeajax()}if(e.sendAsBinary&&m){e.sendAsBinary(i)}else{e.send(i)}return e},array2query:function(c){var b="",a;for(a in c){b+="&"+a+"="+encodeURIComponent(c[a])}return b.substring(1)},form2query:function(a,e,b){var d="",h;function g(i){if(b){h=(i.name==""?"":'\r\nContent-Disposition: form-data; name="'+i.name+'"\r\n\r\n'+encodeURIComponent(i.value)+"\r\n--"+b)}else{h=(i.name==""?"":"&"+i.name+"="+encodeURIComponent(i.value))}return h}if(a!=null){var f=a.getElementsByTagName("input"),j=a.getElementsByTagName("select"),k=a.getElementsByTagName("textarea"),c;for(c=0;c<f.length;c++){if(((f[c].type=="radio"||f[c].type=="checkbox")&&!f[c].checked)||(f[c].type=="button"||f[c].type=="submit")){continue}d+=g(f[c])}for(c=0;c<j.length;c++){d+=g(j[c])}for(c=0;c<k.length;c++){d+=g(k[c])}}if(e){d+=g(e)}return d.substring(1)}},kwf={FULLPATH:"",onclick:null,onload:null,info_timer:null,clicking:function(b){if(b.button>1){return}var a=getTarget(b);if(a.className.indexOf("nolink")>-1||(a.parentNode.className&&a.parentNode.className.indexOf("nolink")>-1)){returnFalse(b)}if(a.className.indexOf("hide-boxing")>-1){boxing.hide()}if(kwf.onclick!=null){kwf.onclick(b,a)}},loading:function(a){if(kwf.onload!=null){kwf.onload(a)}if(elem("content")){content_request.findForms();content_request.dispatchEvent("ready")}},hideInfo:function(){var a=elem("errorlist");if(a){a.parentNode.removeChild(a)}a=elem("infolist");if(a){a.parentNode.removeChild(a)}},infoHandler:function(c){var b="",d,a=kwf;if(c.errors){b+='<ul id="errorlist">';for(d in c.errors){b+="<li>"+c.errors[d]+"</li>"}b+="</ul>"}if(c.info){b+='<ul id="infolist">';for(d in c.info){b+="<li>"+c.info[d]+"</li>"}b+="</ul>"}if(b!=""){a.hideInfo();clearTimeout(a.timer);a.timer=setTimeout(a.hideInfo,10000)}return b}},KWFEventTarget=function(){var a=this;a._listeners={};a.addEventListener=function(b,c){if(typeof a._listeners[b]=="undefined"){a._listeners[b]=[]}a._listeners[b].push(c)};a.removeEventListener=function(d,e){if(a._listeners[d] instanceof Array){var c=a._listeners[d],b;for(b=0;b<c.length;b++){if(""+c[b]===""+e){c.splice(b,1);break}}}};a.dispatchEvent=function(d,g){if(typeof d=="string"){d={type:d};if(typeof g!="undefined"){d.target=g}}if(!d.target){d.target=this}if(!d.type){alert('Request Event object missing "type" property.')}if(a._listeners[d.type] instanceof Array){var c=a._listeners[d.type],b;for(b=0;b<c.length;b++){try{c[b].call(this,d)}catch(f){alert(f.message+" at line "+(f.lineNumber?f.lineNumber:"null")+" in file "+(f.fileName?f.fileName:"null"))}}}}},ContentRequest=function(){var a=this,b=null;a.response=null;a.form_btn=null;a.load=function(d,c){returnFalse(d);b=getTarget(d);a.dispatchEvent("beforeload",b);ajax.get(c,a.parseResponse,a.parseResponse)};a.parseResponse=function(c){var g="",f="",e=elem("content"),d=a.form_btn;a.response=c;a.dispatchEvent("afterload",b);c=a.response;if(c.content_type=="application/json"){g=kwf.infoHandler(c.page);if(c.page.content){f=g+c.page.content}}else{f=c.page}if(f==""&&g!=""){e.insertBefore(toDOMnode(g),e.firstChild)}else{e.innerHTML=f;a.findForms()}a.dispatchEvent("ready",b);b=null;a.response=null;if(d!=null){d.disabled="";a.form_btn=null}};a.findForms=function(){var f=elem("content"),c=f.getElementsByTagName("form"),e,h,g,d;for(e=0;e<c.length;e++){g=c[e];if(g.className.indexOf("ajax-form")>-1){h=(g.action=="")?document.location.href:g.action;addSubmitEvent(g,function(i){returnFalse(i);d=a.form_btn=window.submit_target;d.disabled="disabled";b=getTarget(i);a.dispatchEvent("beforeload",b);ajax.post(h,a.parseResponse,a.parseResponse,b,d)});g.className=g.className.replace(/\bajax-form\b/,"")}}}},BoxingRequest=function(){var a=this,b=null;a.response=null;a.width=0;a.height=0;a.form_btn=null;a.load=function(g,d,f,c){returnFalse(g);b=getTarget(g);a.width=(f?f:300);a.height=(c?c:200);a.dispatchEvent("beforeload",b);ajax.get(d,a.parseResponse,a.parseResponse)};a.parseResponse=function(c){var f="",e="",d=a.form_btn;a.response=c;a.dispatchEvent("afterload",b);c=a.response;if(c.content_type=="application/json"){f=kwf.infoHandler(c.page);if(c.page.content){e=f+c.page.content}}else{e=c.page}if(e==""){if(f!=""){elem("content").insertBefore(toDOMnode(f),elem("content").firstChild)}boxing.hide()}else{boxing.show(e,a.width,a.height);a.findForms()}a.dispatchEvent("ready",b);b=null;a.response=null;if(d!=null){d.disabled="";a.form_btn=null}};a.findForms=function(h){var c=boxing.window.getElementsByTagName("form"),e,g,f,d;for(e=0;e<c.length;e++){f=c[e];if(f.className.indexOf("ajax-form")>-1){g=(f.action=="")?document.location.href:f.action;addSubmitEvent(f,function(i){returnFalse(i);d=window.submit_target;if(d.className.indexOf("hide-boxing")<0){d.disabled="disabled";a.form_btn=d;b=getTarget(i);a.dispatchEvent("beforeload",b);ajax.post(g,a.parseResponse,a.parseResponse,b,d)}});f.className=f.className.replace(/\bajax-form\b/,"")}}}},boxing={initiated:0,state:0,html_tag:null,overlayer:null,close:null,window:null,onhide_callback:null,init:function(){var d=document,c=boxing,a=d.createElement("div"),b=d.createElement("div"),e=d.createElement("a");a.id="boxing-overlayer";c.overlayer=d.body.appendChild(a);addEvent(c.overlayer,"click",c.hide);addEvent(d,"keyup",c.keys);giveOpacity(a,60);e.id="close_boxing";e.className="hide-boxing";e.href="javascript: void(0);";e.appendChild(d.createTextNode("Stäng"));c.close=c.overlayer.appendChild(e);b.id="boxing-window";c.window=d.body.appendChild(b);c.html_tag=d.getElementsByTagName("HTML")[0];c.initiated=1},show:function(f,b,a){if(!boxing.initiated){boxing.init()}var c=boxing,d=c.window,e=c.close;w_unit=(b>100?"px":"%");h_unit=(a>100?"px":"%");c.overlayer.style.display="block";d.style.display="block";e.style.width=d.style.width=b+w_unit;d.style.height=a+h_unit;if(h_unit=="%"){d.style.margin="0 0 0 -"+(b/2)+w_unit;d.style.top=(100-a)/2+"%";e.style.margin="0 0 0 -"+(b/2)+w_unit;e.style.top=(100-a)/2-3+"%"}else{d.style.margin="-"+(a/2)+h_unit+" 0 0 -"+(b/2)+w_unit;d.style.top="50%";e.style.margin="-"+(a/2)-20+h_unit+" 0 0 -"+(b/2)+w_unit;d.style.top="50%";e.style.top="50%"}d.innerHTML=f;c.html_tag.style.overflow="hidden";c.state=1},hide:function(){if(!boxing.initiated){return}var a=boxing,b=a.window;if(a.onhide_callback!=null){if(!a.onhide_callback()){return}}a.overlayer.style.display="none";b.style.display="none";b.innerHTML="";a.html_tag.style.overflow="";a.onhide_callback=null;a.state=0},keys:function(a){if(a.keyCode==27){boxing.hide()}}};ContentRequest.prototype=new KWFEventTarget();content_request=new ContentRequest();BoxingRequest.prototype=new KWFEventTarget();boxing_request=new BoxingRequest();addEvent(document,"click",kwf.clicking);addEvent(window,"load",kwf.loading);